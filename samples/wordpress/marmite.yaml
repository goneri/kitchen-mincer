description: A wordpress in a container (web and DB)

# an account on an OpenStack cloud providing Heat API.
environments:
  devtest:
    identity:
      os_auth_url: http://somewhere
      os_username: myuser
      os_password: mypw
      os_tenant_name: demo
  os-ci-test7:
# Implicite, heat is the default provider.
#    provider: heat
    identity:
#NOTE(Gonéri): Why the os_ prefix?
      os_auth_url: http://os-ci-test7.ring.enovance.com:5000/v2.0
      os_username: admin
      os_password: password
      os_tenant_name: demo
    ip_pool:
      - 172.24.4.3
      - 172.24.4.4
      - 172.24.4.5
      - 172.24.4.6

application:
  # Name of the application, Stack will be called according to this name
  name: wordpress

  # By convention, the heat file will be located here:
  # <root>/applications/<name e.g: wordpress>/heat.yaml

  # Arguments for the heat command (-P), depending on the type, some value may be
  # generated:
  #  - floating_ip: get an IP from the pool depending on its position
  #  - keypair: retrieve a key content from a keys/<name>.pub
  #  - media: returns the image id of the media in Glance
  params:
    - { type: floating_ip, name: ip,  idx: 0 }
    # the keypair(s) to use, keypair name is the filename without the extension,
    # e.g: keys/roberto.pub → roberto
    - { type: keypair, name: roberto_key }
    - { type: value, name: key_name, value: stack_os-ci-test7 }
  medias:
    # A image content computed before the Heat creation
    wp_files:
      type: git
      value: https://github.com/WordPress/WordPress
      # The directory in the image where to store the files
      target: ironic
      ref: 3.8.2
    sql_db_dump:
      type: script
      value: |
              #!/bin/sh
              mysqldump -hdbprod -utoto -ptoto wordpress > wordpress_prod.sql
      target: db
